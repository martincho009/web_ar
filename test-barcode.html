<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
    <title>Test Barcode AR</title>
    
    <!-- A-Frame y AR.js -->
    <script src="https://aframe.io/releases/1.4.0/aframe.min.js"></script>
    <script src="https://cdn.jsdelivr.net/gh/AR-js-org/AR.js@3.4.5/aframe/build/aframe-ar.js"></script>
    
    <style>
        body {
            margin: 0;
            font-family: Arial, sans-serif;
        }
        
        #info {
            position: absolute;
            top: 10px;
            left: 10px;
            background: rgba(0,0,0,0.8);
            color: white;
            padding: 10px;
            border-radius: 5px;
            z-index: 100;
            font-size: 12px;
        }
        
        #debug {
            position: absolute;
            bottom: 10px;
            left: 10px;
            background: rgba(0,0,0,0.8);
            color: lime;
            padding: 10px;
            border-radius: 5px;
            z-index: 100;
            font-size: 11px;
            max-width: 300px;
        }
    </style>
</head>
<body style="margin: 0; overflow: hidden;">
    <div id="info">
        üì± Test Barcode #1<br>
        Apunta al marcador impreso
    </div>
    
    <div id="debug">
        Estado: Iniciando...
    </div>
    
    <!-- Escena AR m√°s simple posible -->
    <a-scene
        vr-mode-ui="enabled: false"
        embedded
        arjs="trackingMethod: best; sourceType: webcam; debugUIEnabled: true; detectionMode: mono_and_matrix; matrixCodeType: 3x3;">
        
        <!-- Marcador Barcode #1 -->
        <a-marker type="barcode" value="1" id="marker1">
            <!-- Solo un cubo rojo simple -->
            <a-box 
                position="0 0.5 0" 
                material="color: red"
                scale="0.5 0.5 0.5">
            </a-box>
            
            <!-- Texto -->
            <a-text
                value="BARCODE 1 DETECTADO!"
                position="0 1.5 0"
                align="center"
                color="yellow"
                scale="2 2 2">
            </a-text>
        </a-marker>
        
        <a-entity camera></a-entity>
    </a-scene>
    
    <script>
        const debug = document.getElementById('debug');
        let markerFound = false;
        
        // Escuchar eventos del marcador
        document.addEventListener('DOMContentLoaded', function() {
            const marker = document.querySelector('#marker1');
            
            marker.addEventListener('markerFound', function() {
                markerFound = true;
                debug.innerHTML = '‚úÖ MARCADOR DETECTADO!<br>Barcode #1 encontrado';
                debug.style.color = '#00ff00';
                console.log('Marcador barcode #1 detectado!');
            });
            
            marker.addEventListener('markerLost', function() {
                markerFound = false;
                debug.innerHTML = '‚ö†Ô∏è Marcador perdido<br>Vuelve a apuntar';
                debug.style.color = '#ffff00';
                console.log('Marcador barcode #1 perdido');
            });
            
            // Estado inicial
            setTimeout(() => {
                if (!markerFound) {
                    debug.innerHTML = 'üîç Buscando marcador...<br>Aseg√∫rate de:<br>- Buena iluminaci√≥n<br>- Marcador plano<br>- Distancia 20-50cm';
                    debug.style.color = '#ff9900';
                }
            }, 3000);
        });
        
        // Debug de c√°mara
        navigator.mediaDevices.getUserMedia({ video: true })
            .then(() => {
                console.log('C√°mara OK');
                debug.innerHTML += '<br>üì∑ C√°mara activa';
            })
            .catch(err => {
                console.error('Error c√°mara:', err);
                debug.innerHTML = '‚ùå Error de c√°mara: ' + err.message;
                debug.style.color = '#ff0000';
            });
    </script>
</body>
</html> 